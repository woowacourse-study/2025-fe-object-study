## 개요

이번 오브젝트 챕터 2를 보며 가장 눈에 들어왔던 부분은 **"적절한 도메인의 결정"** 과 **"인터페이스와 구현의 분리"** 부분이었다. (솔직히 상속을 비롯한 나머지 파트들은 객체가 아닌 클래스에 적용할 수 있는 부분이라 생각했다. 그래서 프로토타입 기반 언어인 자바스크립트에 적용하기 어렵다고 판단했다.)

이번 주차에서는 내 코드 중 레벨1의 로또 미션 코드를 **"적절한 도메인의 결정"** 과 **"인터페이스와 구현의 분리"** 관점에서 다시 한번 살펴보고자 한다. 로또 미션의 경우 도메인과 UI의 분리라는 학습 목표가 있었는데, 이게 인터페이스와 구현의 분리라는 챕터 2의 개념과 일맥상통하는 면이 있다.

## 책 내용 정리(2장)

### 객체 지향 패러다임

- 클래스가 아닌 객체에 초점
  - **어떤 클래스가 필요한 지 고민하기 전에 어떤 객체들이 필요한 지 고민**
  - 객체를 독립적인 존재가 아니라 기능을 구현하기 위해 협력하는 공동체의 일원으로 보기

### 인터페이스와 구현의 분리

- 클래스 작성자와 클라이언트 프로그래머 입장에서 인터페이스/구현의 분리가 중요한 이유
  - 클래스 작성자는 **인터페이스를 해치지 않는 한 구현을 변경**해도 됨
  - 클라이언트 프로그래머는 **구현을 몰라도 인터페이스만 알면 객체를 사용**할 수 있음

### 객체지향 설계의 핵심

- 적절한 **협력**을 식별
- 협력에 필요한 **역할** 정의
- 역할을 수행할 수 있는 적절한 객체에게 적절한 **책임**을 할당

## 기존 로또 코드

[기존 로또 코드](https://github.com/MinSungJe/javascript-lotto/tree/step2/src/domain)의 도메인을 간략히 그려보자면 다음과 같다.

![기존코드](https://github.com/user-attachments/assets/337b0807-be4e-414d-a781-9ce2b817be49)

## "적절한 도메인의 결정"

챕터 2에선 도메인 개념들의 구조를 반영하는 적절한 클래스 구조를 구현하며 본격적인 설명이 시작된다. 도메인이란 문제를 해결하기 위해 사용자가 프로그램을 사용하는 분야를 말한다. 도메인의 개념과 관계를 반영하도록 프로그램을 구조화해야 하기 때문에 클래스의 구조는 도메인의 구조와 유사한 형태를 띠어야 한다.

내가 만든 로또 코드의 도메인은 과연 잘 분리됐을까? 책을 읽고나서 살펴봤을 땐, 조금 부족한 부분이 있었다. **LottoGame의 책임이 너무 많다.**

LottoGame을 살펴보면 현재 다음과 같은 일을 하고 있다.
1. amount를 받아 로또 다발을 구매한다. (constructor)
2. 구매한 로또 다발을 모두 긁어 결과를 얻는다. (calculate)
3. 결과를 기록하고, 초기화한다. (getGameResult, #resetResult)
4. 결과를 가지고 상금과 수익률을 계산한다. (getWinMoney, getEarningRate)

LottoGame이 구매한 Lotto의 개수를 가지고 게임을 진행한다는 관점에서 1~3번까지의 책임은 적절하다. 하지만 결과를 가지고 상금과 수익률을 계산하는 책임은 게임의 통계를 가지고 금전적 가치를 계산하는 약간 다른 종류의 책임이라고 볼 수 있다.

따라서 해당 부분을 결과를 계산하는 별개의 클래스로 분리한다면 적절한 도메인의 결정 방면으로 개선할 수 있다.

![1차개선](https://github.com/user-attachments/assets/d9f7bacc-9084-4196-b9e4-ed8337c57109)

## "인터페이스와 구현의 분리"

객체의 내부와 외부를 확실히 구분하는 것, 즉 경계의 명확성은 객체의 자율성을 보장한다. 객체에게 이래라 저래라 하는 것은 객체가 자율적이라고 할 수 없다. 우리는 객체에게 메세지를 보낼 뿐이고, 객체는 이에 따라 내부의 로직에 의해 나름의 응답을 할 뿐이다. 이때 객체에게 메세지를 보낼 수 있는 요소를 인터페이스, 인터페이스에 의해 요청을 받은 객체가 어떻게 처리할 지 판단하는 로직을 구현부라고 부른다.

인터페이스와 구현의 분리는 레벨2 미션 목표 중 하나인 도메인과 UI의 분리와 비슷한 면이 있다. "도메인과 UI를 분리했다"는 말은 "서비스의 핵심 로직(구현)과 사용자 접점(인터페이스)을 분리하여, 인터페이스와 구현의 분리 원칙을 성공적으로 적용했다"는 의미가 되기 때문이다.

실제 미션코드의 경우 UI 단에서 결과를 계산하는 부분을 최소화했고 이 덕분에 step2에서 터미널 환경을 웹 환경으로 어렵지 않게 변경할 수 있었다. 이는 인터페이스와 구현의 분리가 잘 되어 있어 클라이언트 프로그래머의 입장에서 구현을 몰라도 인터페이스만 알면 터미널이든 웹 환경이든 애플리케이션을 수월하게 만들 수 있다는 것을 보여준다.

한편 완벽히 분리하지 못한 부분 또한 존재한다. **App 내부에 로또 가격을 가지고 로또의 개수를 계산하는 도메인 로직**을 넣었기 때문이다. 이는 처음 LottoGame에서 price를 받아 amount를 계산해 lottos를 만들도록 구현할 수 있다. 또는 LottoGenerator라는 새로운 객체를 만들어 amount를 받고 적절한 수량의 lottos를 관리하도록 구현할 수 있다.

![2차개선](https://github.com/user-attachments/assets/80db88cf-5692-4edc-a3c2-4e62d7d07c5d)

<details><summary><b>부록: 정리노트</b></summary>

![정리노트](https://github.com/user-attachments/assets/e09e8ce6-3daf-4cf0-9378-29f27a20fc11)
</details>