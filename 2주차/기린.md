### 오브젝트 3장을 읽으며
오브젝트 3장은 역할, 책임, 협력에 관한 내용이였다. 객체지향에서 가장 핵심적인 개념이고, 이 책 전반에서 가장 강조하는 주제라고 생각해서 기대되었다. 그리고 이 개념을 리액트 관점에서 어떻게 해석할 수 있을지 의식적으로 고민하면서 읽어보았다.

### 협력을 설계하는 출발점은
3장의 내용에 따르면 객체지향의 본질은 협력하는 객체들의 공동체를 창조하는 것, 그리고 "협력을 설계하는 출발점은 시스템이 제공하는 기능을 시스템이 담당할 하나의 책임으로 바라보는 것"이라고 말한다. 그리고 이 하나의 책임을 완료하는데 필요한 더 작은 책임을 찾아내고 이를 객체들에서 할당하는 "반복적인" 과정을 통해 모양을 갖춰간다고 한다.

이 부분을 읽고 리액트에서 컴포넌트를 나눌 때의 고충이 생각났다. '컴포넌트를 어디까지 작게 나눠야 할까?'를 매 미션을 할 때마다 고민했었는데. 객체지향의 "기능이라는 하나의 큰 책임에서 계속해서 작은 책임으로 나눠가는 과정"을 컴포넌트 나누기에 적용해볼 수 있을 것 같았다.

### 하나의 큰 책임을 더 작은 책임으로 나누기
페이먼츠 미션을 다시 생각해보았다.

이 시스템이 제공하는 기능은 "카드 정보 입력" 하나이다. 이 기능을 시스템이 담당할 하나의 책임으로 바라보았다. 그리고 이 기능을 완성하기 위해서 컴포넌트(객체)들이 협력한다고 생각해보았다.

먼저 "카드 정보를 입력하라"라는 메세지로 협력을 시작할 수 있다. 이 메세지를 처리할 적절한 컴포넌트는 무엇일까? 카드 정보와 관련된 정보를 가장 많이 알고 있는 컴포넌트일 것이다. 즉, 카드 정보를 입력받는 전체 화면이 이 정보의 전문가가이고, 이 메세지를 처리할 적절한 컴포넌트라고 생각했다.

[![image.png](https://i.postimg.cc/4ypSnhXL/image.png)](https://postimg.cc/jndXF2wP)

그 다음, 카드 정보를 입력 받기 위해서는 카드 번호, 유효기간, CVC 번호를 입력 받아야 한다.

**카드 정보 입력 전체 화면 컴포넌트**는 카드 정보에 대해서는 알고 있어도 카드 번호에 필요한 정보를 충분히 알고 있지 않을 것이다(4자리 숫자 4개를 입력해야 한다던지). 
그러면 카드 번호에 대해 잘 알고 있는 다른 컴포넌트에게 도움을 요청해야 한다. 객체가 책임을 수행하게 하는 유일한 방법은 메세지 이기 때문에 새로운 메세지가 필요하다.

아마 "카드 번호를 입력하라"가 새로운 메세지가 될 것이다. 이 메세지를 처리할 적절한 컴포넌트는 무엇일까? 카드 번호에 대한 정보를 가장 많이 알고 있는 컴포넌트는 누구일까?

바로 카드 번호 입력 컴포넌트이다.

[![image.png](https://i.postimg.cc/T2n7VgXQ/image.png)](https://postimg.cc/grkHdwj6)

카드 번호와 마찬가지로 유효기간, CVC 번호 정보를 알기 위해서 "유효기간을 입력하라", "CVC 번호를 입력하라"와 같은 새로운 메세지가 필요하다고 생각했다. 그리고 이 메세지를 처리하기 위해서는 유효기간 입력 컴포넌트, CVC 번호 입력 컴포넌트가 필요하다.

아래와 같은 그림을 보면 하나의 책임이 더 작은 책임, 즉 하나의 컴포넌트가 더 작은 컴포넌트로 분리되었다. 그리고 그 컴포넌트들을 메세지를 통해서 협력하고 있다.

[![image.png](https://i.postimg.cc/0QRGjXrv/image.png)](https://postimg.cc/jWcnkXz3)

### 더 작게 분리하자
이렇게 분리된 컴포넌트들을 더 작게 나눠보자!

- 카드 번호 입력 컴포넌트는 4자리 숫자를 받는 4개의 input으로 구성되어있다. 4자리 숫자를 입력받기 위해서 이 컴포넌트는 input 컴포넌트에게 도움을 요청할 수 있다.
- 유효기간 입력 컴포넌트는 월, 년도을 입력받기 위해서 input 컴포넌트에게 도움을 요청해야 한다.
- CVC 입력 컴포넌트는 3자리 숫자를 입력받기 위해서 input 컴포넌트에게 도움을 요청해야 한다.

그리고 도움을 요청하기 위해서는 새로운 메세지가 필요하다
- "4자리 숫자를 입력하라"
- "월을 입력하라"
- "년도를 입력하라"
- "3자리 숫자를 입력하라" 

이와 같은 4가지 메세지가 필요해졌다.

이 메세지를 처리할 적절한 컴포넌트는 무엇일까?

### 역할
Input이라는 컴포넌트는 위의 4가지의 메세지에 모두 응답할 수 있어야 한다. 그러면 4가지 협력을 모두 개별적으로 만들어야 한다. 이렇게 되면 4가지의 컴포넌트는 중복되는 코드를 가지는데도 개별적으로 구현될 수밖에 없다.

여기서 잠깐 멈춰서 다시 책임을 중심으로 메세지를 바라보았다. 4가지 메세지 모두 "입력하라"라는 동일한 책임을 수행하고 있다는 것을 알 수 있었다. 

그래서 이 "입력하라"라는 메세지에 응답할 수 있는 대표자를 만들고, 입력 방식은 같지만 검증 로직만 다르게 바꿔 끼울수 있는 슬롯 역할을 떠올렸다.

Input 컴포넌트를 "입력"이라는 동일한 책임을 수행하는 **역할**로 추상화 하고, 검증하는 로직만 다르게 바꾸는것이 좋겠다고 생각했다.

이렇게 Input을 **역할**로 보고 검증하는 로직을 바꿔 끼우는 설계를 통해서 4개의 협력을 하나로 통일할 수 있었다.

[![image.png](https://i.postimg.cc/y83SRhM8/image.png)](https://postimg.cc/68w3JZ6k)

### 모든 컴포넌트들 간의 협력 살펴보기
이런 책임을 나누는 과정을 통해, "카드 정보 입력하기"라는 기능을 더 명확하게 컴포넌트들로 나눌 수 있었다. 최종 구조는 아래와 같다.

[![image.png](https://i.postimg.cc/j2jDSy6K/image.png)](https://postimg.cc/phgW0h11)

"카드 정보를 입력하라" 라는 메세지를 시작으로 협력이 이루어졌고, 각 컴포넌트는 메세지를 통해서 서로 협력하며 책임을 수행하고 있다. 


### 결론
오브젝트 3장을 읽으면서 역할, 책임, 협력의 관계를 이해할 수 있었고, 이를 통해서 내가 항상 어려움을 느꼈던 컴포넌트 분리 기준에 대한 실마리를 얻을 수 있었다. 

그리고 구현부터 시작하는게 아니라, 협력을 먼저 생각하는 방식을 시도해보았는데
컴포넌트 간에 요청이 필요할 때는, 먼저 메시지를 정의하고, 그 메시지를 책임질 컴포넌트를 할당했다. 이 방식을 통해서 구현에 의존해서 코드를 작성하지 않고, 설계에 기반한 구현을 경험할 수 있었다.

리액트에서 객체지향적인 패러다임을 떠올리기 쉽지 않았는데, 작게나마 역할-책임-협력 관점으로 접근해볼 수 있어서 좋았다.